<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/WEB-INF/templates/tpl_oaf.xhtml">
    <ui:define name="content">
		<link type="text/css" rel="stylesheet" href="#{resource['css/table_list.css']}" />
		<h:form id="userProfileManager" styleClass="tableContainer">
			<b:growl id="message" showDetail="true" allowDismiss="true" delay="0"/>
			<!--@elvariable id="userSession" type="io.radien.webapp.security.UserSession"-->
			<b:container>
				<b:row>
					<h:panelGroup layout="block" styleClass="headerInformation">
						<h1><h:outputText value="#{msg.rd_user_profile} #{msg.of} #{userSession.userFullName} "/></h1>
						<hr />
					</h:panelGroup>
				</b:row>

				<b:tabView activeIndex="#{userProfileManager.tabIndex}">
					<b:tab title="#{msg.basicInformation}">
						<b:container>
							<b:row><h1/></b:row>
							<b:panelGrid colSpans="2,10">
								<h:outputLabel for="userFirstName" value="#{msg.firstname}"/>
								<b:inputText id="userFirstName" value="#{userSession.userFirstName}" disabled="true" span="6"/>

								<h:outputLabel for="userLastName" value="#{msg.lastname}"/>
								<b:inputText id="userLastName" value="#{userSession.userLastName}" disabled="true" span="6"/>

								<h:outputLabel value="#{msg.logon}"/>
								<b:inputText id="userLogon" value="#{userSession.preferredUserName}" disabled="true" span="6"/>

								<h:outputLabel value="#{msg.email}"/>
								<b:inputText id="userEmail" value="#{userSession.email}" disabled="true" span="6"/>

								<h:outputLabel value="#{msg.sub}"/>
								<b:inputText id="userSub" value="#{userSession.userIdSubject}" disabled="true" span="6"/>
							</b:panelGrid>

							<b:commandButton value="#{msg.rd_home_page}"
											 tooltip="#{msg.returnToHomePage}"
											 iconAwesome="fa-home"
											 action="#{userProfileManager.redirectToHomePage}"/>

						</b:container>
					</b:tab>

					<b:tab title="#{msg.rd_tenants}">
							<b:container>
								<b:row><h1/></b:row>
								<b:row>
									<p:dataTable var="tenantRef"
												 value="#{userProfileManager.assignedTenants}"
												 paginator="true" paginatorPosition="bottom"
												 rows="10" responsive="true"
												 paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
												 currentPageReportTemplate="({currentPage} #{msg.of} {totalPages})"
												 rowsPerPageTemplate="5,10,15,30,50"
												 id="userTenantsTable" emptyMessage="#{msg.noRecordsFound}"
												 info="false" sortOrder="ascending" styleClass="table--2"
												 rowKey="#{tenantRef.id}"
												 selectionMode="single"
												 selection="#{userProfileManager.selectedTenantToUnAssign}">

										<p:ajax event="rowSelect"
												listener="#{userProfileManager.onTenantSelect}"
												update="@all"/>

										<p:column headerText="#{msg.id}">
											<h:outputText value="#{tenantRef.id}" />
										</p:column>
										<p:column headerText="#{msg.name}">
											<h:outputText value="#{tenantRef.name}" />
										</p:column>
										<p:column headerText="#{msg.rd_tenant} #{msg.type} ">
											<h:outputText value="#{tenantRef.tenantType}" />
										</p:column>
									</p:dataTable>
								</b:row>
								<b:row><h1/></b:row>
							</b:container>
							<b:buttonGroup>

								<b:commandButton id="cancelUserTenantDissociation"
												 value="#{msg.rd_cancel_association}"
												 tooltip="#{msg.returnToHomePage}"
												 iconAwesome="fa-home"
												 immediate="true"
												 action="#{userProfileManager.redirectToHomePage}"/>

								<b:button id="userTenantDissociation"
										  value="#{msg.dissociate}"
										  tooltip="#{msg.dissociate} #{msg.rd_user} #{msg.rd_tenant}"
										  iconAwesome="fa-ban"
										  onclick="$('.formValidationModalDeleteTenantFromUserProfile').modal('show')"/>

								<b:modal id="modalDissociation"
										 title="#{msg.confirmation}"
										 styleClass="formValidationModalDeleteTenantFromUserProfile"
										 closable="false"
										 close-on-escape="false" backdrop="false">
									<p>#{msg.rd_tenant_self_dissociation_confirmation}</p>
									<f:facet name="footer">
										<b:commandButton value="#{msg.returnButton}"
														 type="reset"
														 onclick="{ $('.formValidationModalDeleteTenantFromUserProfile').modal('hide') } "/>
										<b:commandButton value="#{msg.yes}" look="warning"
														 action="#{userProfileManager.dissociateUserTenant}"
														 oncomplete="{ $('.formValidationModalDeleteTenantFromUserProfile').modal('hide') } "/>
									</f:facet>
								</b:modal>
							</b:buttonGroup>
					</b:tab>
				</b:tabView>
			</b:container>
		</h:form>
    </ui:define>
</ui:composition>